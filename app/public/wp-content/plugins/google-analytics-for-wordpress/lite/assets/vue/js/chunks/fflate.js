var O=Uint8Array,S=Uint16Array,rr=Uint32Array,vr=new O([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fr=new O([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tr=new O([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kr=function(r,a){for(var n=new S(31),e=0;e<31;++e)n[e]=a+=1<<r[e-1];for(var f=new rr(n[30]),e=1;e<30;++e)for(var i=n[e];i<n[e+1];++i)f[i]=i-n[e]<<5|e;return[n,f]},yr=kr(vr,2),zr=yr[0],cr=yr[1];zr[28]=258,cr[258]=28;var Cr=kr(fr,0),Sr=Cr[0],Fr=Cr[1],wr=new S(32768);for(var w=0;w<32768;++w){var Z=(w&43690)>>>1|(w&21845)<<1;Z=(Z&52428)>>>2|(Z&13107)<<2,Z=(Z&61680)>>>4|(Z&3855)<<4,wr[w]=((Z&65280)>>>8|(Z&255)<<8)>>>1}var X=function(r,a,n){for(var e=r.length,f=0,i=new S(a);f<e;++f)++i[r[f]-1];var t=new S(a);for(f=0;f<a;++f)t[f]=t[f-1]+i[f-1]<<1;var c;if(n){c=new S(1<<a);var o=15-a;for(f=0;f<e;++f)if(r[f])for(var u=f<<4|r[f],v=a-r[f],s=t[r[f]-1]++<<v,g=s|(1<<v)-1;s<=g;++s)c[wr[s]>>>o]=u}else for(c=new S(e),f=0;f<e;++f)c[f]=wr[t[r[f]-1]++]>>>15-r[f];return c},$=new O(288);for(var w=0;w<144;++w)$[w]=8;for(var w=144;w<256;++w)$[w]=9;for(var w=256;w<280;++w)$[w]=7;for(var w=280;w<288;++w)$[w]=8;var ar=new O(32);for(var w=0;w<32;++w)ar[w]=5;var Ur=X($,9,0),br=X($,9,1),qr=X(ar,5,0),Br=X(ar,5,1),or=function(r){for(var a=r[0],n=1;n<r.length;++n)r[n]>a&&(a=r[n]);return a},K=function(r,a,n){var e=a/8>>0;return(r[e]|r[e+1]<<8)>>>(a&7)&n},lr=function(r,a){var n=a/8>>0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>>(a&7)},sr=function(r){return(r/8>>0)+(r&7&&1)},Er=function(r,a,n){(a==null||a<0)&&(a=0),(n==null||n>r.length)&&(n=r.length);var e=new(r instanceof S?S:r instanceof rr?rr:O)(n-a);return e.set(r.subarray(a,n)),e},Pr=function(r,a,n){var e=r.length,f=!a||n,i=!n||n.i;n||(n={}),a||(a=new O(e*3));var t=function(nr){var m=a.length;if(nr>m){var j=new O(Math.max(m*2,nr));j.set(a),a=j}},c=n.f||0,o=n.p||0,u=n.b||0,v=n.l,s=n.d,g=n.m,h=n.n,y=e*8;do{if(!v){n.f=c=K(r,o,1);var _=K(r,o+1,3);if(o+=3,_)if(_==1)v=br,s=Br,g=9,h=5;else if(_==2){var N=K(r,o,31)+257,H=K(r,o+10,15)+4,b=N+K(r,o+5,31)+1;o+=14;for(var k=new O(b),M=new O(19),l=0;l<H;++l)M[tr[l]]=K(r,o+l*3,7);o+=H*3;var I=or(M),q=(1<<I)-1;if(!i&&o+b*(I+7)>y)break;for(var L=X(M,I,1),l=0;l<b;){var z=L[K(r,o,q)];o+=z&15;var x=z>>>4;if(x<16)k[l++]=x;else{var R=0,C=0;for(x==16?(C=3+K(r,o,3),o+=2,R=k[l-1]):x==17?(C=3+K(r,o,7),o+=3):x==18&&(C=11+K(r,o,127),o+=7);C--;)k[l++]=R}}var B=k.subarray(0,N),F=k.subarray(N);g=or(B),h=or(F),v=X(B,g,1),s=X(F,h,1)}else throw"invalid block type";else{var x=sr(o)+4,G=r[x-4]|r[x-3]<<8,U=x+G;if(U>e){if(i)throw"unexpected EOF";break}f&&t(u+G),a.set(r.subarray(x,U),u),n.b=u+=G,n.p=o=U*8;continue}if(o>y)throw"unexpected EOF"}f&&t(u+131072);for(var A=(1<<g)-1,T=(1<<h)-1,Q=g+h+18;i||o+Q<y;){var R=v[lr(r,o)&A],V=R>>>4;if(o+=R&15,o>y)throw"unexpected EOF";if(!R)throw"invalid length/literal";if(V<256)a[u++]=V;else if(V==256){v=null;break}else{var D=V-254;if(V>264){var l=V-257,J=vr[l];D=K(r,o,(1<<J)-1)+zr[l],o+=J}var W=s[lr(r,o)&T],P=W>>>4;if(!W)throw"invalid distance";o+=W&15;var F=Sr[P];if(P>3){var J=fr[P];F+=lr(r,o)&(1<<J)-1,o+=J}if(o>y)throw"unexpected EOF";f&&t(u+131072);for(var E=u+D;u<E;u+=4)a[u]=a[u-F],a[u+1]=a[u+1-F],a[u+2]=a[u+2-F],a[u+3]=a[u+3-F];u=E}}n.l=v,n.p=o,n.b=u,v&&(c=1,n.m=g,n.d=s,n.n=h)}while(!c);return u==a.length?a:Er(a,0,u)},Y=function(r,a,n){n<<=a&7;var e=a/8>>0;r[e]|=n,r[e+1]|=n>>>8},p=function(r,a,n){n<<=a&7;var e=a/8>>0;r[e]|=n,r[e+1]|=n>>>8,r[e+2]|=n>>>16},ur=function(r,a){for(var n=[],e=0;e<r.length;++e)r[e]&&n.push({s:e,f:r[e]});var f=n.length,i=n.slice();if(!f)return[new O(0),0];if(f==1){var t=new O(n[0].s+1);return t[n[0].s]=1,[t,1]}n.sort(function(b,k){return b.f-k.f}),n.push({s:-1,f:25001});var c=n[0],o=n[1],u=0,v=1,s=2;for(n[0]={s:-1,f:c.f+o.f,l:c,r:o};v!=f-1;)c=n[n[u].f<n[s].f?u++:s++],o=n[u!=v&&n[u].f<n[s].f?u++:s++],n[v++]={s:-1,f:c.f+o.f,l:c,r:o};for(var g=i[0].s,e=1;e<f;++e)i[e].s>g&&(g=i[e].s);var h=new S(g+1),y=hr(n[v-1],h,0);if(y>a){var e=0,_=0,x=y-a,G=1<<x;for(i.sort(function(k,M){return h[M.s]-h[k.s]||k.f-M.f});e<f;++e){var U=i[e].s;if(h[U]>a)_+=G-(1<<y-h[U]),h[U]=a;else break}for(_>>>=x;_>0;){var N=i[e].s;h[N]<a?_-=1<<a-h[N]++-1:++e}for(;e>=0&&_;--e){var H=i[e].s;h[H]==a&&(--h[H],++_)}y=a}return[new O(h),y]},hr=function(r,a,n){return r.s==-1?Math.max(hr(r.l,a,n+1),hr(r.r,a,n+1)):a[r.s]=n},Ar=function(r){for(var a=r.length;a&&!r[--a];);for(var n=new S(++a),e=0,f=r[0],i=1,t=function(o){n[e++]=o},c=1;c<=a;++c)if(r[c]==f&&c!=a)++i;else{if(!f&&i>2){for(;i>138;i-=138)t(32754);i>2&&(t(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(t(f),--i;i>6;i-=6)t(8304);i>2&&(t(i-3<<5|8208),i=0)}for(;i--;)t(f);i=1,f=r[c]}return[n.subarray(0,e),a]},d=function(r,a){for(var n=0,e=0;e<a.length;++e)n+=r[e]*a[e];return n},er=function(r,a,n){var e=n.length,f=sr(a+2);r[f]=e&255,r[f+1]=e>>>8,r[f+2]=r[f]^255,r[f+3]=r[f+1]^255;for(var i=0;i<e;++i)r[f+i+4]=n[i];return(f+4+e)*8},_r=function(r,a,n,e,f,i,t,c,o,u,v){Y(a,v++,n),++f[256];for(var s=ur(f,15),g=s[0],h=s[1],y=ur(i,15),_=y[0],x=y[1],G=Ar(g),U=G[0],N=G[1],H=Ar(_),b=H[0],k=H[1],M=new S(19),l=0;l<U.length;++l)M[U[l]&31]++;for(var l=0;l<b.length;++l)M[b[l]&31]++;for(var I=ur(M,7),q=I[0],L=I[1],z=19;z>4&&!q[tr[z-1]];--z);var R=u+5<<3,C=d(f,$)+d(i,ar)+t,B=d(f,g)+d(i,_)+t+14+3*z+d(M,q)+(2*M[16]+3*M[17]+7*M[18]);if(R<=C&&R<=B)return er(a,v,r.subarray(o,o+u));var F,A,T,Q;if(Y(a,v,1+(B<C)),v+=2,B<C){F=X(g,h,0),A=g,T=X(_,x,0),Q=_;var V=X(q,L,0);Y(a,v,N-257),Y(a,v+5,k-1),Y(a,v+10,z-4),v+=14;for(var l=0;l<z;++l)Y(a,v+3*l,q[tr[l]]);v+=3*z;for(var D=[U,b],J=0;J<2;++J)for(var W=D[J],l=0;l<W.length;++l){var P=W[l]&31;Y(a,v,V[P]),v+=q[P],P>15&&(Y(a,v,W[l]>>>5&127),v+=W[l]>>>12)}}else F=Ur,A=$,T=qr,Q=ar;for(var l=0;l<c;++l)if(e[l]>255){var P=e[l]>>>18&31;p(a,v,F[P+257]),v+=A[P+257],P>7&&(Y(a,v,e[l]>>>23&31),v+=vr[P]);var E=e[l]&31;p(a,v,T[E]),v+=Q[E],E>3&&(p(a,v,e[l]>>>5&8191),v+=fr[E])}else p(a,v,F[e[l]]),v+=A[e[l]];return p(a,v,F[256]),v+A[256]},Rr=new rr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Tr=new O(0),Dr=function(r,a,n,e,f,i){var t=r.length,c=new O(e+t+5*(1+Math.floor(t/7e3))+f),o=c.subarray(e,c.length-f),u=0;if(!a||t<8)for(var v=0;v<=t;v+=65535){var s=v+65535;s<t?u=er(o,u,r.subarray(v,s)):(o[v]=i,u=er(o,u,r.subarray(v,t)))}else{for(var g=Rr[a-1],h=g>>>13,y=g&8191,_=(1<<n)-1,x=new S(32768),G=new S(_+1),U=Math.ceil(n/3),N=2*U,H=function(ir){return(r[ir]^r[ir+1]<<U^r[ir+2]<<N)&_},b=new rr(25e3),k=new S(288),M=new S(32),l=0,I=0,v=0,q=0,L=0,z=0;v<t;++v){var R=H(v),C=v&32767,B=G[R];if(x[C]=B,G[R]=C,L<=v){var F=t-v;if((l>7e3||q>24576)&&F>423){u=_r(r,o,0,b,k,M,I,q,z,v-z,u),q=l=I=0,z=v;for(var A=0;A<286;++A)k[A]=0;for(var A=0;A<30;++A)M[A]=0}var T=2,Q=0,V=y,D=C-B&32767;if(F>2&&R==H(v-D))for(var J=Math.min(h,F)-1,W=Math.min(32767,v),P=Math.min(258,F);D<=W&&--V&&C!=B;){if(r[v+T]==r[v+T-D]){for(var E=0;E<P&&r[v+E]==r[v+E-D];++E);if(E>T){if(T=E,Q=D,E>J)break;for(var nr=Math.min(D,E-2),m=0,A=0;A<nr;++A){var j=v-D+A+32768&32767,Or=x[j],gr=j-Or+32768&32767;gr>m&&(m=gr,B=j)}}}C=B,B=x[C],D+=C-B+32768&32767}if(Q){b[q++]=268435456|cr[T]<<18|Fr[Q];var xr=cr[T]&31,Mr=Fr[Q]&31;I+=vr[xr]+fr[Mr],++k[257+xr],++M[Mr],L=v+T,++l}else b[q++]=r[v],++k[r[v]]}}u=_r(r,o,i,b,k,M,I,q,z,v-z,u),i||(u=er(o,u,Tr))}return Er(c,0,e+sr(u)+f)},Gr=function(){var r=1,a=0;return{p:function(n){for(var e=r,f=a,i=n.length,t=0;t!=i;){for(var c=Math.min(t+5552,i);t<c;++t)e+=n[t],f+=e;e%=65521,f%=65521}r=e,a=f},d:function(){return(r>>>8<<16|(a&255)<<8|a>>>8)+((r&255)<<23)*2}}},Hr=function(r,a,n,e,f){return Dr(r,a.level==null?6:a.level,a.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+a.mem,n,e,!f)},Ir=function(r,a,n){for(;n;++a)r[a]=n,n>>>=8},Jr=function(r,a){var n=a.level,e=n==0?0:n<6?1:n==9?3:2;r[0]=120,r[1]=e<<6|(e?32-2*e:1)},Kr=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Nr(r,a){a===void 0&&(a={});var n=Gr();n.p(r);var e=Hr(r,a,2,4);return Jr(e,a),Ir(e,e.length-4,n.d()),e}function Qr(r,a){return Pr((Kr(r),r.subarray(2,-4)),a)}export{Qr as u,Nr as z};
